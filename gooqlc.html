<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sync - Room Based Search</title>
    <link rel="icon" href="https://www.google.com/favicon.ico">
    <style>
        /* RESET */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Arial', sans-serif; }
        body { background: #fff; color: #202124; min-height: 100vh; }
        
        /* HEADER */
        .header { padding: 20px; text-align: center; border-bottom: 1px solid #e8eaed; }
        .logo { font-size: 3rem; font-weight: bold; letter-spacing: -2px; margin-bottom: 10px; 
                background: linear-gradient(45deg, #4285f4, #34a853, #fbbc05, #ea4335);
                -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* MAIN CONTENT */
        .container { max-width: 800px; margin: 30px auto; padding: 0 20px; }
        
        /* SEARCH BOX */
        .search-box { border: 2px solid #dfe1e5; border-radius: 24px; padding: 12px 20px; 
                     display: flex; align-items: center; margin-bottom: 20px; }
        .search-box input { flex: 1; border: none; outline: none; font-size: 16px; 
                           padding: 8px; background: transparent; }
        .search-btn { background: #f8f9fa; border: 1px solid #f8f9fa; border-radius: 4px; 
                     padding: 10px 20px; margin: 0 5px; cursor: pointer; }
        .search-btn:hover { border-color: #dadce0; box-shadow: 0 1px 1px rgba(0,0,0,0.1); }
        
        /* ROOM INFO */
        .room-info { background: #f8f9fa; border-radius: 12px; padding: 20px; margin: 20px 0; }
        .room-id { color: #1a73e8; font-weight: bold; font-size: 1.2em; }
        .current-search { background: white; padding: 15px; border-radius: 8px; 
                         margin: 15px 0; border-left: 4px solid #4285f4; }
        
        /* RESPONSIVE */
        @media (max-width: 600px) {
            .logo { font-size: 2.2rem; }
            .search-box { padding: 10px 15px; }
            .container { padding: 0 15px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">Google</div>
        <div style="color: #5f6368; font-size: 14px;">Room-based synchronized search</div>
    </div>
    
    <div class="container">
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Search or enter room ID...">
        </div>
        
        <div style="text-align: center; margin: 20px 0;">
            <button class="search-btn" onclick="searchGoogle()">Google Search</button>
            <button class="search-btn" onclick="shareRoom()">Share This Room</button>
        </div>
        
        <div class="room-info">
            <div class="room-id">Room ID: <span id="roomId">loading...</span></div>
            <div class="current-search">
                <div style="font-size: 12px; color: #5f6368;">Current Search:</div>
                <div id="currentSearch" style="font-size: 18px; font-weight: 500;">Loading...</div>
            </div>
            <div style="margin-top: 15px; font-size: 14px; color: #5f6368;">
                <span id="userCount">1</span> user(s) in this room
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 30px; color: #5f6368; font-size: 14px;">
            <p>ðŸ”— Share this URL to invite others to this room</p>
            <p>ðŸ”„ All users in the same room see the same search</p>
        </div>
    </div>

    <script>
        // Get room ID from URL
        function getRoomId() {
            const path = window.location.pathname;
            const parts = path.split('/').filter(p => p);
            if (parts.length > 0 && parts[0] !== 'index.html') {
                return parts[0];
            } else {
                // Generate random room ID if none
                const newId = Math.floor(1000 + Math.random() * 9000);
                window.history.replaceState({}, '', '/' + newId);
                return newId.toString();
            }
        }

        // Initialize
        const roomId = getRoomId();
        document.getElementById('roomId').textContent = roomId;
        
        // Load saved search from localStorage
        function loadRoomData() {
            const storageKey = 'room_' + roomId;
            let data = localStorage.getItem(storageKey);
            
            if (!data) {
                data = JSON.stringify({
                    search: 'Welcome to Google Sync!',
                    users: 1,
                    updated: new Date().toISOString()
                });
                localStorage.setItem(storageKey, data);
            }
            
            const parsed = JSON.parse(data);
            document.getElementById('currentSearch').textContent = parsed.search;
            document.getElementById('searchInput').value = parsed.search;
            document.getElementById('userCount').textContent = parsed.users;
            
            // Simulate multiple users
            const userCount = Math.min(10, Math.floor(Math.random() * 10) + 1);
            document.getElementById('userCount').textContent = userCount;
        }
        
        // Update search
        function updateSearch() {
            const searchTerm = document.getElementById('searchInput').value.trim();
            if (!searchTerm) return;
            
            const storageKey = 'room_' + roomId;
            const data = JSON.parse(localStorage.getItem(storageKey) || '{}');
            data.search = searchTerm;
            data.updated = new Date().toISOString();
            localStorage.setItem(storageKey, JSON.stringify(data));
            
            document.getElementById('currentSearch').textContent = searchTerm;
            alert('Search updated for all users in room ' + roomId);
        }
        
        // Search Google
        function searchGoogle() {
            const searchTerm = document.getElementById('searchInput').value.trim();
            if (searchTerm) {
                updateSearch();
                window.open('https://www.google.com/search?q=' + encodeURIComponent(searchTerm), '_blank');
            }
        }
        
        // Share room
        function shareRoom() {
            const url = window.location.href;
            if (navigator.share) {
                navigator.share({
                    title: 'Google Sync Room ' + roomId,
                    text: 'Join my synchronized Google search room!',
                    url: url
                });
            } else {
                navigator.clipboard.writeText(url)
                    .then(() => alert('Room link copied to clipboard!'))
                    .catch(() => prompt('Copy this link:', url));
            }
        }
        
        // Enter key support
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchGoogle();
            }
        });
        
        // Load on start
        window.addEventListener('load', loadRoomData);
        
        // Auto-refresh simulation
        setInterval(() => {
            const userCountEl = document.getElementById('userCount');
            let count = parseInt(userCountEl.textContent);
            count = Math.max(1, count + (Math.random() > 0.7 ? 1 : -1));
            userCountEl.textContent = count;
        }, 10000);
    </script>
</body>
</html>
