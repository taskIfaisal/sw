<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Magic Ball">

<title>Magic Ball</title>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
}

html, body {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    touch-action: none;
}

.container {
    position: fixed;
    inset: 0;
    width: 100vw;
    height: 100dvh;
    background: linear-gradient(135deg, #10B981 0%, #059669 100%);
    background-size: cover;
    background-position: center;
    overflow: hidden;
}

#ball {
    position: absolute;
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #ffffff, #f0f0f0);
    background-size: cover;
    background-position: center;
    will-change: transform;
}

/* SETTINGS */
#settings {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(8px);
    display: none;
    z-index: 9999;
}

.settings-panel {
    position: absolute;
    bottom: 0;
    width: 100%;
    padding: 20px;
    background: #111;
    border-radius: 20px 20px 0 0;
    color: #fff;
}

.settings-panel h3 {
    margin: 10px 0;
    font-size: 15px;
}

.settings-panel input {
    width: 100%;
    margin-bottom: 10px;
}

.settings-panel button {
    width: 100%;
    padding: 12px;
    border-radius: 12px;
    border: none;
    background: #10B981;
    color: #fff;
    font-size: 14px;
}
</style>
</head>

<body>

<div class="container" id="container">
    <div id="ball"></div>
</div>

<div id="settings">
    <div class="settings-panel">
        <h3>Upload Background</h3>
        <input type="file" accept="image/*" onchange="uploadBackground(this)">

        <h3>Upload Object Ball</h3>
        <input type="file" accept="image/*" onchange="uploadBall(this)">

        <button onclick="closeSettings()">Close</button>
    </div>
</div>

<script>
const container = document.getElementById('container');
const ball = document.getElementById('ball');
const settings = document.getElementById('settings');

/* ===== LOAD SAVED ASSETS ===== */
const savedBg = localStorage.getItem('magic_bg');
if (savedBg) {
    container.style.backgroundImage = `url(${savedBg})`;
}

const savedBall = localStorage.getItem('magic_ball');
if (savedBall) {
    ball.style.backgroundImage = `url(${savedBall})`;
}

/* ===== UPLOAD HANDLERS ===== */
function uploadBackground(input) {
    const file = input.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = e => {
        container.style.backgroundImage = `url(${e.target.result})`;
        localStorage.setItem('magic_bg', e.target.result);
    };
    reader.readAsDataURL(file);
}

function uploadBall(input) {
    const file = input.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = e => {
        ball.style.backgroundImage = `url(${e.target.result})`;
        localStorage.setItem('magic_ball', e.target.result);
    };
    reader.readAsDataURL(file);
}

/* ===== SETTINGS CONTROL ===== */
function openSettings() {
    settings.style.display = 'block';
}
function closeSettings() {
    settings.style.display = 'none';
}

/* ===== 2 FINGER SWIPE ===== */
let startY = 0;
window.addEventListener('touchstart', e => {
    if (e.touches.length === 2) {
        startY = (e.touches[0].clientY + e.touches[1].clientY) / 2;
    }
});

window.addEventListener('touchmove', e => {
    if (e.touches.length === 2) {
        const y = (e.touches[0].clientY + e.touches[1].clientY) / 2;
        if (y - startY > 120) openSettings();
    }
});
</script>

</body>
</html>
